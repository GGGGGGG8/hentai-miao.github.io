(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{565:function(t,a,s){"use strict";s.r(a);var e=s(4),n=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_1-å¼•è¨€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-å¼•è¨€","aria-hidden":"true"}},[t._v("#")]),t._v(" 1 å¼•è¨€")]),t._v(" "),s("p",[t._v("Immer æ˜¯ 18 å¹´ç«èµ·æ¥çš„é¡¹ç›®ï¼Œç”± "),s("a",{attrs:{href:"https://github.com/mobxjs/mobx",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mobx"),s("OutboundLink")],1),t._v(" ä½œè€… "),s("a",{attrs:{href:"https://github.com/mweststrate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mweststrate"),s("OutboundLink")],1),t._v(" ç ”å‘")]),t._v(" "),s("p",[t._v("äº†è§£ mobx çš„åŒå­¦ä¼šå‘ç°ï¼ŒImmer å°±æ˜¯æ›´åº•å±‚çš„ Mobxï¼Œå®ƒå°† Mobx çš„ç‰¹æ€§å‘æ‰¬å…‰å¤§ï¼Œå¾—ä»¥ç»“åˆåˆ°ä»»ä½•æ•°æ®æµæ¡†æ¶ï¼Œä½¿ç”¨èµ·æ¥éå¸¸ä¼˜é›…")]),t._v(" "),s("h2",{attrs:{id:"_2-æ¦‚è¿°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-æ¦‚è¿°","aria-hidden":"true"}},[t._v("#")]),t._v(" 2 æ¦‚è¿°")]),t._v(" "),s("h3",{attrs:{id:"éº»çƒ¦çš„-immutable"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#éº»çƒ¦çš„-immutable","aria-hidden":"true"}},[t._v("#")]),t._v(" éº»çƒ¦çš„ Immutable")]),t._v(" "),s("p",[t._v("Immer æƒ³è§£å†³çš„é—®é¢˜ï¼Œæ˜¯åˆ©ç”¨å…ƒç¼–ç¨‹ç®€åŒ– Immutable ä½¿ç”¨çš„å¤æ‚åº¦ã€‚ä¸¾ä¸ªä¾‹å­ ğŸŒ°ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªçº¯å‡½æ•°ï¼š")]),t._v(" "),s("div",{staticClass:"language-tsx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("addProducts")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("products")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cloneProducts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("products"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  cloneProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"shoes"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" cloneProducts\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("è™½ç„¶ä»£ç ä¸å¤æ‚ï¼Œä½†æ˜¯å†™èµ·æ¥ä¾ç„¶å†…å¿ƒä¸çˆ½ï¼Œæˆ‘ä»¬å¿…é¡»å°† "),s("code",[t._v("products")]),t._v(" æ‹·è´ä¸€ä»½ï¼Œå†è°ƒç”¨ "),s("code",[t._v("push")]),t._v(" å‡½æ•°ä¿®æ”¹åˆ·æ–° "),s("code",[t._v("cloneProducts")]),t._v("ï¼Œå†è¿”å›å®ƒ")]),t._v(" "),s("p",[t._v("å¦‚æœåŸç”Ÿ JS æ”¯æŒ "),s("code",[t._v("Immutable")]),t._v("ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ "),s("code",[t._v("push")]),t._v(" äº†ï¼Œè€Œ "),s("code",[t._v("Immer")]),t._v(" å°±è®© JS ç°åœ¨å°±æ”¯æŒï¼š")]),t._v(" "),s("div",{staticClass:"language-tsx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" addProducts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("produce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("products")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  products"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shoes'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("å¾ˆæœ‰è¶£å§ï¼Œè¿™ä¸¤ä¸ª "),s("code",[t._v("addProducts")]),t._v(" å‡½æ•°åŠŸèƒ½ä¸€æ¨¡ä¸€æ ·ï¼Œè€Œä¸”éƒ½æ˜¯çº¯å‡½æ•°")]),t._v(" "),s("h3",{attrs:{id:"åˆ«æ‰­çš„-setstate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ«æ‰­çš„-setstate","aria-hidden":"true"}},[t._v("#")]),t._v(" åˆ«æ‰­çš„ setState")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬çŸ¥é“ï¼Œreact æ¡†æ¶ä¸­ "),s("code",[t._v("setState")]),t._v(" æ”¯æŒå‡½æ•°å¼å†™æ³•ï¼š")]),t._v(" "),s("div",{staticClass:"language-tsx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  isShow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("é…åˆè§£æ„è¯­æ³•ï¼Œå†™èµ·æ¥ä»ç„¶æ˜¯å¦‚æ­¤ä¼˜é›…ï¼Œé‚£ä¹ˆæ•°æ®ç¨å¾®å¤æ‚ä¸€ç‚¹å‘¢ï¼Ÿå°±è¦å¿å—ç³Ÿç³•çš„ "),s("code",[t._v("Immutable")]),t._v(" äº†ï¼š")]),t._v(" "),s("div",{staticClass:"language-tsx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cloneProducts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("products"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  cloneProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shoes'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    cloneProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("ä½†æ˜¯å¼•å…¥ "),s("code",[t._v("Immer")]),t._v(" ä¹‹åä¸€åˆ‡éƒ½æ”¹å˜äº†ï¼š")]),t._v(" "),s("div",{staticClass:"language-tsx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("produce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isShow "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("produce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("products"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shoes'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("è¿™å°±æ˜¯ "),s("code",[t._v("Immer")]),t._v("ï¼š"),s("code",[t._v("Create the next immutable state by mutating the current one.")])]),t._v(" "),s("h2",{attrs:{id:"_3-ç²¾è¯»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-ç²¾è¯»","aria-hidden":"true"}},[t._v("#")]),t._v(" 3 ç²¾è¯»")]),t._v(" "),s("p",[s("code",[t._v("Immer")]),t._v(" æ˜¯æ›´åº•å±‚çš„æ‹¼å›¾ï¼Œå®ƒå¯ä»¥æ’å…¥åˆ°ä»»ä½•æ•°æ®æµæ¡†æ¶ä½œä¸ºåŠŸèƒ½å¢å¼ºï¼Œä¸å¾—ä¸æ„Ÿå¹ Mweststrate çœŸçš„éå¸¸é«˜ç»è¿œç©")]),t._v(" "),s("p",[s("code",[t._v("Immer")]),t._v(" æ˜¯ä¸€ä¸ªæ”¯æŒæŸ¯é‡ŒåŒ–ï¼Œ"),s("strong",[t._v("ä»…æ”¯æŒåŒæ­¥è®¡ç®—çš„å·¥å…·")]),t._v("ï¼Œæ‰€ä»¥éå¸¸é€‚åˆä½œä¸º "),s("code",[t._v("redux")]),t._v(" çš„ "),s("code",[t._v("reducer")]),t._v(" ä½¿ç”¨")]),t._v(" "),s("blockquote",[s("p",[t._v("Immer ä¹Ÿæ”¯æŒç›´æ¥ return valueï¼Œè¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æ­¤åŠŸèƒ½è·³è¿‡ä¸è°ˆ")]),t._v(" "),s("p",[t._v("PS: mutable ä¸ return ä¸èƒ½åŒæ—¶è¿”å›ä¸åŒå¯¹è±¡ï¼Œå¦åˆ™å¼„ä¸æ¸…æ¥šåˆ°å“ªç§ä¿®æ”¹æ˜¯æœ‰æ•ˆçš„")])]),t._v(" "),s("p",[t._v("æŸ¯é‡ŒåŒ–è¯¦æƒ…è‡ªè¡ŒæŸ¥çœ‹ "),s("a",{attrs:{href:"https://github.com/dominictarr/curry",target:"_blank",rel:"noopener noreferrer"}},[t._v("curry"),s("OutboundLink")],1),t._v("ï¼Œæˆ‘ä»¬æ¥çœ‹ "),s("code",[t._v("produce")]),t._v(" å‡½æ•°çš„ "),s("code",[t._v("callback")]),t._v(" éƒ¨åˆ†ï¼š")]),t._v(" "),s("div",{staticClass:"language-tsx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("produce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("draft")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  draft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("code",[t._v("obj")]),t._v(" æ˜¯ä¸ªæ™®é€šå¯¹è±¡ï¼Œé‚£ä¹ˆé»‘é­”æ³•ä¸€å®šå‡ºç°åœ¨ "),s("code",[t._v("draft")]),t._v(" å¯¹è±¡ï¼Œ"),s("code",[t._v("Immer")]),t._v(" ç»™ "),s("code",[t._v("draft")]),t._v(" å¯¹è±¡çš„æ‰€æœ‰å±æ€§åšäº†ç›‘å¬")]),t._v(" "),s("p",[t._v("æ‰€ä»¥æ•´ä½“æ€è·¯å°±æœ‰äº†ï¼š"),s("code",[t._v("draft")]),t._v(" æ˜¯ "),s("code",[t._v("obj")]),t._v(" çš„ä»£ç†ï¼Œå¯¹ "),s("code",[t._v("draft")]),t._v(" mutable çš„ä¿®æ”¹éƒ½ä¼šæµå…¥åˆ°è‡ªå®šä¹‰ "),s("code",[t._v("setter")]),t._v(" å‡½æ•°ï¼Œå®ƒå¹¶ä¸ä¿®æ”¹åŸå§‹å¯¹è±¡çš„å€¼ï¼Œè€Œæ˜¯é€’å½’çˆ¶çº§ä¸æ–­æµ…æ‹·è´ï¼Œæœ€ç»ˆè¿”å›æ–°çš„é¡¶å±‚å¯¹è±¡ï¼Œä½œä¸º "),s("code",[t._v("produce")]),t._v(" å‡½æ•°çš„è¿”å›å€¼")]),t._v(" "),s("h3",{attrs:{id:"ç”Ÿæˆä»£ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç”Ÿæˆä»£ç†","aria-hidden":"true"}},[t._v("#")]),t._v(" ç”Ÿæˆä»£ç†")]),t._v(" "),s("p",[t._v("ç¬¬ä¸€æ­¥ï¼Œä¹Ÿå°±æ˜¯å°† "),s("code",[t._v("obj")]),t._v(" è½¬ä¸º "),s("code",[t._v("draft")]),t._v(" è¿™ä¸€æ­¥ï¼Œä¸ºäº†æé«˜ "),s("code",[t._v("Immutable")]),t._v(" çš„è¿è¡Œæ•ˆç‡ï¼Œéœ€è¦ä¸€äº›é¢å¤–ä¿¡æ¯ï¼Œå› æ­¤å°† "),s("code",[t._v("obj")]),t._v(" å°è£…æˆä¸€ä¸ªåŒ…å«é¢å¤–ä¿¡æ¯çš„ä»£ç†å¯¹è±¡ï¼š")]),t._v(" "),s("div",{staticClass:"language-tsx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tmodified"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ˜¯å¦è¢«ä¿®æ”¹è¿‡")]),t._v("\n  finalized"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ˜¯å¦å·²ç»å®Œæˆï¼ˆæ‰€æœ‰ setter å®Œæˆï¼Œå¹¶ä¸”å·²ç»ç”Ÿæˆäº† copyï¼‰")]),t._v("\n  parent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// çˆ¶çº§å¯¹è±¡")]),t._v("\n  base"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åŸå§‹å¯¹è±¡")]),t._v("\n  copy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// baseï¼ˆä¹Ÿå°±æ˜¯ objï¼‰çš„æµ…æ‹·è´ï¼Œä½¿ç”¨ Object.assign(Object.create(null), obj)å®ç°")]),t._v("\n  proxies"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å­˜å‚¨æ¯ä¸ª propertyKey çš„ä»£ç†å¯¹è±¡ï¼Œé‡‡ç”¨æ‡’åˆå§‹åŒ–ç­–ç•¥")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("åœ¨è¿™ä¸ªä»£ç†å¯¹è±¡ä¸Šï¼Œç»‘å®šäº†è‡ªå®šä¹‰ "),s("code",[t._v("getter")]),t._v("ã€"),s("code",[t._v("setter")]),t._v("ï¼Œç„¶åç›´æ¥å°†å…¶æ‰”ç»™ "),s("code",[t._v("produce")]),t._v(" æ‰§è¡Œ")]),t._v(" "),s("h3",{attrs:{id:"getter"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getter","aria-hidden":"true"}},[t._v("#")]),t._v(" getter")]),t._v(" "),s("p",[s("code",[t._v("produce")]),t._v(" å›è°ƒå‡½æ•°ä¸­åŒ…å«äº†ç”¨æˆ·çš„ "),s("code",[t._v("mutable")]),t._v(" ä»£ç ï¼Œæ‰€ä»¥ç°åœ¨å…¥å£å˜æˆäº† "),s("code",[t._v("getter")]),t._v(" ä¸ "),s("code",[t._v("setter")])]),t._v(" "),s("p",[s("code",[t._v("getter")]),t._v(" ä¸»è¦ç”¨æ¥æ‡’åˆå§‹åŒ–ä»£ç†å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯å½“ä»£ç†å¯¹è±¡å­å±æ€§è¢«è®¿é—®çš„æ—¶å€™ï¼Œæ‰ä¼šç”Ÿæˆå…¶ä»£ç†å¯¹è±¡")]),t._v(" "),s("p",[t._v("è¿™ä¹ˆè¯´æ¯”è¾ƒæŠ½è±¡ï¼Œæˆ‘ä»¬ä¸¾ä¸ª ğŸŒ° ï¼š")]),t._v(" "),s("div",{staticClass:"language-tsx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\ta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\tb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\tc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("é‚£ä¹ˆåˆå§‹æƒ…å†µä¸‹ï¼Œ"),s("code",[t._v("draft")]),t._v(" æ˜¯ "),s("code",[t._v("obj")]),t._v(" çš„ä»£ç†ï¼Œæ‰€ä»¥è®¿é—® "),s("code",[t._v("draft.a")]),t._v("ã€"),s("code",[t._v("draft.b")]),t._v("ã€"),s("code",[t._v("draft.c")]),t._v(" æ—¶ï¼Œéƒ½èƒ½è§¦å‘ "),s("code",[t._v("getter")]),t._v("ã€"),s("code",[t._v("setter")]),t._v("ï¼Œè¿›å…¥è‡ªå®šä¹‰å¤„ç†é€»è¾‘ï¼Œå¯æ˜¯å¯¹ "),s("code",[t._v("draft.a.x")]),t._v(" ç›¸å½“äºè®¿é—®äº† "),s("code",[t._v("draftA.x")]),t._v("ï¼Œæ‰€ä»¥èƒ½é€’å½’ç›‘å¬ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§")]),t._v(" "),s("p",[t._v("åŒæ—¶ï¼Œå¦‚æœä»£ç ä¸­åªè®¿é—®äº† "),s("code",[t._v("draft.a")]),t._v("ï¼Œé‚£ä¹ˆåªä¼šåœ¨å†…å­˜ç”Ÿæˆ "),s("code",[t._v("draftA")]),t._v(" ä»£ç†ï¼Œ"),s("code",[t._v("b")]),t._v(" "),s("code",[t._v("c")]),t._v(" å±æ€§å› ä¸ºæ²¡æœ‰è®¿é—®ï¼Œå› æ­¤ä¸éœ€è¦æµªè´¹èµ„æºç”Ÿæˆä»£ç† "),s("code",[t._v("draftB")]),t._v("ã€"),s("code",[t._v("draftC")])]),t._v(" "),s("p",[t._v("å½“ç„¶ Immer åšäº†ä¸€äº›æ€§èƒ½ä¼˜åŒ–ï¼Œä»¥åŠåœ¨å¯¹è±¡è¢«ä¿®æ”¹è¿‡ï¼ˆ"),s("code",[t._v("modified")]),t._v("ï¼‰è·å–å…¶ "),s("code",[t._v("copy")]),t._v(" å¯¹è±¡ï¼Œä¸ºäº†ä¿è¯ "),s("code",[t._v("base")]),t._v(" æ˜¯ä¸å¯å˜çš„ï¼Œè¿™é‡Œä¸åšå±•å¼€")]),t._v(" "),s("h3",{attrs:{id:"setter"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setter","aria-hidden":"true"}},[t._v("#")]),t._v(" setter")]),t._v(" "),s("p",[t._v("å½“å¯¹ "),s("code",[t._v("draft")]),t._v(" ä¿®æ”¹æ—¶ï¼Œä¼šå¯¹ "),s("code",[t._v("base")]),t._v(" ä¹Ÿå°±æ˜¯åŸå§‹å€¼è¿›è¡Œæµ…æ‹·è´ï¼Œä¿å­˜åˆ° "),s("code",[t._v("copy")]),t._v(" å±æ€§ï¼ŒåŒæ—¶å°† "),s("code",[t._v("modified")]),t._v(" å±æ€§è®¾ç½®ä¸º "),s("code",[t._v("true")]),t._v("ã€‚è¿™æ ·å°±å®Œæˆäº†æœ€é‡è¦çš„ "),s("code",[t._v("Immutable")]),t._v(" è¿‡ç¨‹ï¼Œè€Œä¸”æµ…æ‹·è´å¹¶ä¸æ˜¯å¾ˆæ¶ˆè€—æ€§èƒ½ï¼ŒåŠ ä¸Šæ˜¯æŒ‰éœ€æµ…æ‹·è´ï¼Œå› æ­¤ "),s("code",[t._v("Immer")]),t._v(" çš„æ€§èƒ½è¿˜å¯ä»¥")]),t._v(" "),s("p",[t._v("åŒæ—¶ä¸ºäº†ä¿è¯æ•´æ¡é“¾è·¯çš„å¯¹è±¡éƒ½æ˜¯æ–°å¯¹è±¡ï¼Œä¼šæ ¹æ® "),s("code",[t._v("parent")]),t._v(" å±æ€§é€’å½’çˆ¶çº§ï¼Œä¸æ–­æµ…æ‹·è´ï¼Œç›´åˆ°è¿™ä¸ªå¶å­èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹æ•´æ¡é“¾è·¯å¯¹è±¡éƒ½æ¢æ–°ä¸ºæ­¢")]),t._v(" "),s("h3",{attrs:{id:"ç”Ÿæˆ-immutable-å¯¹è±¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç”Ÿæˆ-immutable-å¯¹è±¡","aria-hidden":"true"}},[t._v("#")]),t._v(" ç”Ÿæˆ Immutable å¯¹è±¡")]),t._v(" "),s("p",[t._v("å½“æ‰§è¡Œå®Œ "),s("code",[t._v("produce")]),t._v(" åï¼Œç”¨æˆ·çš„æ‰€æœ‰ä¿®æ”¹å·²ç»å®Œæˆï¼ˆæ‰€ä»¥ "),s("code",[t._v("Immer")]),t._v(" æ²¡æœ‰æ”¯æŒå¼‚æ­¥ï¼‰ï¼Œå¦‚æœ "),s("code",[t._v("modified")]),t._v(" å±æ€§ä¸º "),s("code",[t._v("false")]),t._v(" ï¼Œè¯´æ˜ç”¨æˆ·æ ¹æœ¬æ²¡æœ‰æ›´æ”¹è¿™ä¸ªå¯¹è±¡ï¼Œé‚£ç›´æ¥è¿”å›åŸå§‹ "),s("code",[t._v("base")]),t._v(" å±æ€§å³å¯")]),t._v(" "),s("p",[t._v("å¦‚æœ "),s("code",[t._v("modified")]),t._v(" å±æ€§ä¸º "),s("code",[t._v("true")]),t._v("ï¼Œè¯´æ˜å¯¹è±¡å‘ç”Ÿäº†æ”¹å˜ï¼Œè¿”å› "),s("code",[t._v("copy")]),t._v(" å±æ€§å³å¯ã€‚ä½†æ˜¯ "),s("code",[t._v("setter")]),t._v(" è¿‡ç¨‹æ˜¯é€’å½’çš„ï¼Œ"),s("code",[t._v("draft")]),t._v(" çš„å­å¯¹è±¡ä¹Ÿæ˜¯ "),s("code",[t._v("draft")]),t._v("ï¼ˆåŒ…å«äº† "),s("code",[t._v("base")]),t._v("ã€"),s("code",[t._v("copy")]),t._v("ã€"),s("code",[t._v("modified")]),t._v(" ç­‰é¢å¤–å±æ€§çš„ä»£ç†ï¼‰ï¼Œæˆ‘ä»¬å¿…é¡»ä¸€å±‚å±‚é€’å½’ï¼Œæ‹¿åˆ°çœŸæ­£çš„å€¼")]),t._v(" "),s("p",[t._v("æ‰€ä»¥åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ‰€æœ‰ "),s("code",[t._v("draft")]),t._v(" çš„ "),s("code",[t._v("finalized")]),t._v(" éƒ½æ˜¯ "),s("code",[t._v("false")]),t._v("ã€"),s("code",[t._v("copy")]),t._v(" å†…éƒ¨å¯èƒ½è¿˜å­˜åœ¨å¤§é‡ "),s("code",[t._v("draft")]),t._v(" å±æ€§ï¼Œå› æ­¤é€’å½’ "),s("code",[t._v("base")]),t._v(" ä¸ "),s("code",[t._v("copy")]),t._v(" çš„å­å±æ€§ï¼Œå¦‚æœç›¸åŒï¼Œå°±ç›´æ¥è¿”å›ï¼›å¦‚æœä¸åŒï¼Œé€’å½’ä¸€æ¬¡æ•´ä¸ªè¿‡ç¨‹")]),t._v(" "),s("p",[t._v("æœ€åè¿”å›çš„å¯¹è±¡æ˜¯ç”± "),s("code",[t._v("base")]),t._v(" çš„ä¸€äº›å±æ€§ï¼ˆæ²¡æœ‰ä¿®æ”¹çš„éƒ¨åˆ†ï¼‰å’Œ "),s("code",[t._v("copy")]),t._v(" çš„ä¸€äº›å±æ€§ï¼ˆä¿®æ”¹çš„éƒ¨åˆ†ï¼‰æœ€ç»ˆæ‹¼æ¥è€Œæˆçš„ã€‚æœ€åä½¿ç”¨ "),s("code",[t._v("freeze")]),t._v(" å†»ç»“ "),s("code",[t._v("copy")]),t._v(" å±æ€§ï¼Œå°† "),s("code",[t._v("finalized")]),t._v(" å±æ€§è®¾ç½®ä¸º "),s("code",[t._v("true")])]),t._v(" "),s("p",[t._v("è‡³æ­¤ï¼Œè¿”å›å€¼ç”Ÿæˆå®Œæ¯•ï¼Œæˆ‘ä»¬å°†æœ€ç»ˆå€¼ä¿å­˜åœ¨ "),s("code",[t._v("copy")]),t._v(" å±æ€§ä¸Šï¼Œå¹¶å°†å…¶å†»ç»“ï¼Œè¿”å›äº† "),s("code",[t._v("Immutable")]),t._v(" çš„å€¼")]),t._v(" "),s("p",[s("code",[t._v("Immer")]),t._v(" å› æ­¤å®Œæˆäº†ä¸å¯æ€è®®çš„æ“ä½œï¼š"),s("code",[t._v("Create the next immutable state by mutating the current one")])]),t._v(" "),s("blockquote",[s("p",[t._v("æºç è¯»åˆ°è¿™é‡Œï¼Œå‘ç° Immer å…¶å®å¯ä»¥æ”¯æŒå¼‚æ­¥ï¼Œåªè¦æ”¯æŒ produce å‡½æ•°è¿”å› Promise å³å¯ã€‚æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œæœ€åå¯¹ä»£ç†çš„ "),s("code",[t._v("revoke")]),t._v(" æ¸…æ´—ï¼Œéœ€è¦å€ŸåŠ©å…¨å±€å˜é‡ï¼Œè¿™ä¸€ç‚¹é˜»ç¢äº† Immer å¯¹å¼‚æ­¥çš„æ”¯æŒã€‚")])]),t._v(" "),s("h2",{attrs:{id:"_4-æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-æ€»ç»“","aria-hidden":"true"}},[t._v("#")]),t._v(" 4 æ€»ç»“")]),t._v(" "),s("p",[t._v("è¯»åˆ°è¿™ï¼Œå¦‚æœè§‰å¾—ä¸è¿‡ç˜¾ï¼Œå¯ä»¥çœ‹çœ‹ "),s("a",{attrs:{href:"https://github.com/anish000kumar/redux-box",target:"_blank",rel:"noopener noreferrer"}},[t._v("redux-box"),s("OutboundLink")],1),t._v(" è¿™ä¸ªåº“ï¼Œåˆ©ç”¨ immer + redux è§£å†³äº† reducer å†—ä½™ "),s("code",[t._v("return")]),t._v(" çš„é—®é¢˜ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("åŒæ ·æˆ‘ä»¬ä¹Ÿå¼€å§‹æ€è€ƒå¹¶è®¾è®¡æ–°çš„æ•°æ®æµæ¡†æ¶ï¼Œç¬”è€…åœ¨ 2018.3.24 çš„æºç¨‹æŠ€æœ¯æ²™é¾™å°†ä¼šåˆ†äº« "),s("a",{attrs:{href:"http://mp.weixin.qq.com/s/54BJPM7aldH6yq6qj2Yrpw",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€Šmvvm å‰ç«¯æ•°æ®æµæ¡†æ¶ç²¾è®²ã€‹"),s("OutboundLink")],1),t._v("ï¼Œåˆ†äº«è¿™å‡ å¹´æ¶Œç°çš„å„å¥—æ•°æ®æµæŠ€æœ¯æ–¹æ¡ˆç ”ç©¶å¿ƒå¾—ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦æ¬¢è¿æŠ¥åå‚åŠ ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"_5-æ›´å¤šè®¨è®º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-æ›´å¤šè®¨è®º","aria-hidden":"true"}},[t._v("#")]),t._v(" 5 æ›´å¤šè®¨è®º")]),t._v(" "),s("p",[t._v("è®¨è®ºåœ°å€æ˜¯ï¼š[ç²¾è¯»ã€ŠImmer.jsã€‹æºç ã€‹ Â· Issue #68 Â· dt-fe/weekly](")])])},[],!1,null,null,null);a.default=n.exports}}]);